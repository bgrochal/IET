<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:util="http://www.springframework.org/schema/util"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
						   http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd
						   http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd">

	<!-- Required to process annotations -->
	<context:annotation-config/>

	<!-- Definition of the stop condition - computation stops after 5 seconds -->
	<bean id="stop-condition" class="pl.edu.agh.age.compute.stream.TimedStopCondition">
		<constructor-arg value="20" type="long"/>
	</bean>

	<!-- Definition of the step function for Rastrigin evaluator -->
	<bean id="recombination" class="pl.edu.agh.age.function.common.recombination.CloserToZeroRecombination"/>
	<bean id="evaluator" class="pl.edu.agh.age.compute.stream.problem.rastrigin.RastriginEvaluator"/>
	<bean id="step" class="pl.edu.agh.age.function.common.step.FunctionStep">
		<constructor-arg ref="recombination"/>
		<constructor-arg ref="evaluator"/>
	</bean>

	<!-- Definition of the after-step analyzer -->
	<bean id="population-analyzer" class="pl.edu.agh.age.compute.stream.example.SampleAfterStepAction"/>

	<!-- Definition of agents -->
	<util:list id="agents-rastrigin" value-type="pl.edu.agh.age.compute.stream.emas.EmasAgent">
		<bean class="pl.edu.agh.age.function.rastrigin.agent.generator.RandomRastriginAgentGenerator" factory-method="randomAgent"/>
		<bean class="pl.edu.agh.age.function.rastrigin.agent.generator.RandomRastriginAgentGenerator" factory-method="randomAgent"/>
		<bean class="pl.edu.agh.age.function.rastrigin.agent.generator.RandomRastriginAgentGenerator" factory-method="randomAgent"/>
		<bean class="pl.edu.agh.age.function.rastrigin.agent.generator.RandomRastriginAgentGenerator" factory-method="randomAgent"/>
		<bean class="pl.edu.agh.age.function.rastrigin.agent.generator.RandomRastriginAgentGenerator" factory-method="randomAgent"/>
		<bean class="pl.edu.agh.age.function.rastrigin.agent.generator.RandomRastriginAgentGenerator" factory-method="randomAgent"/>
	</util:list>

	<!-- Definition of workplaces -->
	<bean id="workplace-1" class="pl.edu.agh.age.compute.stream.configuration.WorkplaceConfiguration">
		<constructor-arg ref="step"/>
		<constructor-arg ref="agents-rastrigin"/>
		<constructor-arg ref="population-analyzer"/>
	</bean>
	<bean id="workplace-2" class="pl.edu.agh.age.compute.stream.configuration.WorkplaceConfiguration">
		<constructor-arg ref="step"/>
		<constructor-arg ref="agents-rastrigin"/>
		<constructor-arg ref="population-analyzer"/>
	</bean>

	<util:list id="workplace-configurations"
	           value-type="pl.edu.agh.age.compute.stream.configuration.WorkplaceConfiguration">
		<ref bean="workplace-1"/>
		<ref bean="workplace-2"/>
	</util:list>

	<!-- Definition of the logging service -->
	<bean id="loggingService" class="pl.edu.agh.age.compute.stream.logging.NoOpLoggingService"/>

	<!-- Definition of the solution topology -->
	<bean id="topology" class="pl.edu.agh.age.compute.api.topology.FullMeshTopology" />

	<!-- Initializer of configuration -->
	<bean id="configuration" class="pl.edu.agh.age.compute.stream.configuration.Configuration"/>

	<!-- Define main class -->
	<bean id="runnable" class="pl.edu.agh.age.compute.stream.StreamAgents"/>

</beans>
